exports.id=954,exports.ids=[954],exports.modules={1848:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a={src:"/_next/static/media/icon_X.58f98ea4.svg",height:36,width:36,blurWidth:0,blurHeight:0}},9511:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a={src:"/_next/static/media/icon_alarm.8971da1e.svg",height:36,width:36,blurWidth:0,blurHeight:0}},5414:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a={src:"/_next/static/media/icon_chatting.02eb0d0f.svg",height:64,width:64,blurWidth:0,blurHeight:0}},7197:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a={src:"/_next/static/media/icon_coconut.f423e621.svg",height:48,width:48,blurWidth:0,blurHeight:0}},887:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a={src:"/_next/static/media/icon_default.55ed01ec.svg",height:36,width:36,blurWidth:0,blurHeight:0}},4197:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a={src:"/_next/static/media/icon_logo_img.e4adc1fd.svg",height:646,width:988,blurWidth:0,blurHeight:0}},3333:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a={src:"/_next/static/media/icon_menu.6d1848f9.svg",height:36,width:36,blurWidth:0,blurHeight:0}},9106:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a={src:"/_next/static/media/img_avatar1.15dee258.svg",height:92,width:92,blurWidth:0,blurHeight:0}},3520:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a={src:"/_next/static/media/img_avatar3.3f7a7f89.svg",height:92,width:92,blurWidth:0,blurHeight:0}},3546:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.d(t,{A:()=>R});var s=r(8732),l=r(1106),c=r.n(l),i=r(5454),n=r(9965),o=r.n(n),d=r(4197),h=r(3333),u=r(2015),m=r(1848),g=r(9511),x=r(887),p=r(5414),f=r(7197),b=r(6897),j=r(8e3),w=r(3642),y=r(6358),N=r(6715),v=r(8462),A=r(4055),k=r(2787),E=e([i,b,j,w,y,v]);[i,b,j,w,y,v]=E.then?(await E)():E;let F={guest:[{href:"/finding-maker",label:"Maker 찾기"}],DREAMER:[{href:"/plan-request",label:"여행 요청"},{href:"/finding-maker",label:"Maker 찾기"},{href:"/mytrip-manage/ongoing-plan",label:"내 여행 관리",group:"mytrip-manage"}],MAKER:[{href:"/receive",label:"받은 요청",group:"receive"},{href:"/managequo",label:"내 견적 관리",group:"managequo"}]},S=()=>y.A.getNotification(),R=()=>{let{isLoggedIn:e,nickName:t,role:r,coconut:a,setLogin:l}=(0,i.A)(),[n,y]=(0,u.useState)(!1),[E,R]=(0,u.useState)(!1),[_,T]=(0,u.useState)(!1),[D,M]=(0,u.useState)(null),[I,$]=(0,u.useState)([]),[C,U]=(0,u.useState)(x.A.src),L=(0,u.useRef)(null),O=(0,u.useRef)(null),H=(0,u.useRef)(null),W=(0,N.useRouter)(),{realTimeNotifications:z}=(0,k.A)(),q=e=>{switch(e.group){case"receive":return["/receive","/all-receive-plan"].includes(W.pathname);case"managequo":return["/managequo","/rejectlist"].includes(W.pathname);case"mytrip-manage":return W.pathname.startsWith("/mytrip-manage/");default:return W.pathname===e.href}},P=()=>{let t=F[e?r:"guest"].some(e=>q(e));return(0,s.jsx)(s.Fragment,{children:F[e?r:"guest"].map((e,r)=>{let a=q(e);return(0,s.jsx)("li",{children:(0,s.jsx)(c(),{href:e.href,onClick:()=>y(!1),className:`${t?a?"bold text-color-black-500":"text-color-gray-500":"text-color-black-500"}`,children:e.label})},r)})})},{data:Q=[]}=(0,v.useQuery)({queryKey:["hasNotification"],queryFn:S,enabled:e});(0,u.useEffect)(()=>{e&&Q&&$(Q)},[e,Q]),(0,u.useEffect)(()=>{localStorage.getItem("accessToken")&&(async()=>{try{let e=await w.A.getUserInfo(),t=await w.A.getProfileInfo();M(e);let r=A.A.find(e=>e.key===t.image);U(r?r.src:x.A.src),l(e.nickName,e.role,e.coconut)}catch(e){console.error(e)}})()},[l]),(0,u.useEffect)(()=>{let e=e=>{_&&L.current&&!L.current.contains(e.target)&&T(!1),E&&O.current&&!O.current.contains(e.target)&&R(!1),n&&H.current&&!H.current.contains(e.target)&&y(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[_,E,n]);let K=Q.some(e=>!e.isRead);return(0,s.jsxs)("div",{className:"z-40 flex items-center justify-between border-b-2 border-color-line-100 bg-color-background-100 px-32 py-6 mobile:px-4 tablet:px-5 mobile-tablet:py-3",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"mr-16 text-2xl font-bold mobile-tablet:mr-0",children:(0,s.jsx)(c(),{href:"/",children:(0,s.jsx)(o(),{src:d.A,width:100,alt:"니가가라하와이 로고"})})}),(0,s.jsx)("ul",{className:"bold hidden space-x-4 text-lg pc:flex",children:P()})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[e?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex cursor-pointer items-center space-x-2",children:[(0,s.jsx)(o(),{src:f.A,alt:"코코넛",width:24,height:24}),(0,s.jsxs)("p",{className:"regular",children:[a,"p"]})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(c(),{href:"/chatting",children:(0,s.jsx)(o(),{src:p.A,alt:"채팅",width:36,height:36,className:"cursor-pointer"})}),(0,s.jsx)("span",{className:"absolute right-0 top-0 h-2 w-2 animate-ping rounded-full bg-color-red-200"}),(0,s.jsx)("span",{className:"absolute right-0 top-0 h-2 w-2 rounded-full bg-color-red-200"})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(o(),{src:g.A,alt:"알림",width:36,height:36,onClick:()=>{R(e=>!e)},className:"cursor-pointer"}),K&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"absolute right-0 top-0 h-2 w-2 animate-ping rounded-full bg-color-red-200"}),(0,s.jsx)("span",{className:"absolute right-0 top-0 h-2 w-2 rounded-full bg-color-red-200"})]})]}),E&&(0,s.jsx)("div",{ref:O,className:"absolute z-50",children:(0,s.jsx)(b.A,{closeModal:()=>{R(!1)}})}),null===I&&null,(0,s.jsxs)("div",{className:"flex cursor-pointer items-center space-x-2",onClick:()=>{T(e=>!e)},ref:L,children:[(0,s.jsx)(o(),{src:C,alt:"유저이미지",width:36,height:36,className:"rounded-full"}),(0,s.jsxs)("span",{className:"medium hidden text-2lg pc:block",children:[t," ",r]})]}),_&&(0,s.jsx)("div",{ref:L,className:"absolute z-50",children:(0,s.jsx)(j.A,{userId:D?.id,closeMenu:()=>{T(!1)}})})]}):(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(c(),{href:"/login",children:(0,s.jsx)("button",{className:"semibold mobile-tablet:py-2) rounded-2xl bg-color-blue-300 px-10 py-3 text-2lg text-white hover:bg-color-blue-200 mobile-tablet:px-4 mobile-tablet:text-md",children:"로그인"})})}),(0,s.jsx)(o(),{src:h.A,alt:"메뉴",width:30,height:30,className:"block cursor-pointer pc:hidden",onClick:()=>{y(!0)}})]}),n&&(0,s.jsx)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-end bg-black bg-opacity-50",children:(0,s.jsxs)("div",{className:"flex h-full w-[220px] flex-col bg-white p-4 shadow-lg",ref:H,children:[(0,s.jsx)("div",{className:"mb-4 flex justify-end",children:(0,s.jsx)(o(),{src:m.A,alt:"닫기",width:36,height:36,className:"cursor-pointer",onClick:()=>y(!1)})}),(0,s.jsx)("div",{className:"h-0.5 bg-color-line-100"}),(0,s.jsx)("ul",{className:"bold mt-6 flex cursor-pointer flex-col gap-y-10 space-y-4 text-lg",children:P()})]})}),z.length>0&&(0,s.jsx)("div",{className:"fixed left-0 top-20 z-50 flex w-full flex-col gap-2 px-4 py-2",children:z.map(e=>(0,s.jsx)("div",{className:"bold w-full rounded-xl bg-color-red-100 p-4 text-center text-color-black-500",children:(0,s.jsxs)("p",{children:["\uD83D\uDD14 ",e.content]})},e.id))})]})};a()}catch(e){a(e)}})},6897:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.d(t,{A:()=>m});var s=r(8732),l=r(9965),c=r.n(l),i=r(1848),n=r(6358),o=r(4846),d=r(8462),h=r(2015),u=e([n,d]);[n,d]=u.then?(await u)():u;let g=()=>n.A.getNotification(),x=e=>n.A.readNotification(e),p={FOOD_TOUR:"맛집 탐방형",SHOPPING:"기념품/쇼핑형",RELAXATION:"휴양형",CULTURE:"문화/역사탐방형",ACTIVITY:"액티비티/탐험형",FESTIVAL:"축제참여형"},f=e=>p[e]||"알 수 없는 여행 타입",b=(e,t)=>{switch(e){case"ARRIVE_REQUEST":return(0,s.jsxs)(s.Fragment,{children:[t.nickName," Dreamer가",(0,s.jsxs)("span",{className:"text-color-blue-300",children:[" ",f(t.tripType)]}),(0,s.jsx)("span",{className:"text-color-red-200",children:" 지정견적"}),"을 요청했어요."]});case"CONFIRM_REQUEST":return(0,s.jsxs)(s.Fragment,{children:[t.nickName," Dreamer의 견적이 ",(0,s.jsx)("span",{className:"text-color-blue-300",children:"확정"}),"되었어요."]});case"SCHEDULE":return(0,s.jsxs)(s.Fragment,{children:["내일은 ",(0,s.jsx)("span",{className:"text-color-blue-300",children:t.planTitle}),(0,s.jsx)("span",{className:"text-color-red-200",children:" 여행 예정일"}),"이에요."]});case"ARRIVE_QUOTE":return(0,s.jsxs)(s.Fragment,{children:[t.nickName," Maker의",(0,s.jsxs)("span",{className:"text-color-blue-300",children:[" ",f(t.tripType)]}),(0,s.jsx)("span",{className:"text-color-red-200",children:" 견적"}),"이 도착했어요."]});case"CONFIRM_QUOTE":return(0,s.jsxs)(s.Fragment,{children:[t.nickName," Maker의 견적이 ",(0,s.jsx)("span",{className:"text-color-blue-300",children:"확정"}),"되었어요."]});case"REJECT_REQUEST":return(0,s.jsxs)(s.Fragment,{children:[t.nickName," Maker가"," ",(0,s.jsx)("span",{className:"text-color-blue-300",children:t.planTitle}),"지정견적 요청을 ",(0,s.jsx)("span",{className:"text-color-red-200",children:"반려"}),"했어요."]});case"REJECT_QUOTE":return(0,s.jsxs)(s.Fragment,{children:[t.nickName," Dreamer가"," ",(0,s.jsx)("span",{className:"text-color-blue-300",children:t.planTitle}),"견적을 ",(0,s.jsx)("span",{className:"text-color-red-200",children:"반려"}),"했어요."]});default:return(0,s.jsx)(s.Fragment,{children:"알 수 없는 이벤트입니다."})}};function m({closeModal:e}){let{data:t=[],isLoading:r}=(0,d.useQuery)({queryKey:["notificationData"],queryFn:g}),[a,l]=(0,h.useState)(t),n=(0,d.useMutation)({mutationFn:x,onSuccess:e=>{l(t=>t.map(t=>t.id===e.id?{...t,isRead:!0}:t))},onError:e=>{console.error(e)}}),u=async e=>{n.mutate(e)};return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:"fixed right-16 top-20 z-[9999] tablet:right-20 pc:right-64",children:(0,s.jsxs)("div",{className:"semibold w-[300px] rounded-2xl border bg-color-gray-50 py-3 text-2xl shadow-lg pc:w-[360px]",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between pl-8 pr-5",children:[(0,s.jsx)("span",{className:"text-2lg",children:"알림"}),(0,s.jsx)(c(),{src:i.A,alt:"닫기",width:36,height:36,onClick:e,className:"cursor-pointer"})]}),r?(0,s.jsx)("p",{className:"mb-8 px-5 text-lg",children:"로딩 중..."}):0===a.length?(0,s.jsx)("p",{className:"mb-8 px-5 text-lg",children:"새로운 알림이 없습니다."}):(0,s.jsx)("div",{className:`max-h-[300px] overflow-y-auto ${a.length>=4?"h-[300px]":""}`,children:(0,s.jsx)("ul",{children:a.map((e,t)=>(0,s.jsx)("div",{children:(0,s.jsxs)("li",{onClick:()=>u(e.id),className:`cursor-pointer pt-4 ${e.isRead?"bg-[#f1f1f1]":"bg-color-gray-50"}`,children:[(0,s.jsx)("p",{className:"px-5 text-lg",children:b(e.event,e.payload)}),(0,s.jsx)("p",{className:"px-5 pb-4 text-md text-color-gray-300",children:(0,o.fw)(e.createdAt)}),t<a.length-1&&(0,s.jsx)("div",{className:"h-0.5 bg-color-line-100"})]})},e.id))})})]})})})}a()}catch(e){a(e)}})},8e3:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.d(t,{A:()=>d});var s=r(8732),l=r(5454),c=r(1106),i=r.n(c),n=r(6715),o=e([l]);function d({userId:e,closeMenu:t}){let{nickName:r,role:a,setLogout:c}=(0,l.A)(),o=(0,n.useRouter)();return"guest"===a?null:(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:"fixed right-20 top-20 z-[9999] flex tablet:right-16",children:(0,s.jsxs)("div",{className:"flex w-[248px] flex-col gap-6 rounded-2xl border bg-color-gray-50 px-2 pt-6 shadow-lg mobile-tablet:w-[152px]",children:[(0,s.jsx)("div",{className:"flex items-center justify-between px-6 mobile-tablet:pl-2",children:(0,s.jsxs)("span",{className:"bold text-2lg mobile-tablet:text-lg",children:[r,a]})}),(0,s.jsx)("div",{children:(0,s.jsx)("ul",{className:"medium flex flex-col gap-6 px-6 text-lg mobile-tablet:pl-2 mobile-tablet:text-md",children:(()=>{let r={DREAMER:[{href:e?`/profile/dreamer/edit/${e}`:"",label:"프로필 수정"},{href:"/follow-maker",label:"찜한 Maker"},{href:"/myreview-manage/completed-trip",label:"여행 리뷰"}],MAKER:[{href:e?`/profile/maker/mypage/${e}`:"",label:"마이페이지"}]};return(0,s.jsx)(s.Fragment,{children:r[a||"DREAMER"].map((e,r)=>(0,s.jsx)("li",{children:(0,s.jsx)(i(),{href:e.href,onClick:t,children:e.label})},r))})})()})}),(0,s.jsx)("div",{className:"h-[1px] w-full bg-color-line-100"}),(0,s.jsx)("div",{className:"flex cursor-pointer justify-center pb-4 text-color-gray-500 mobile-tablet:text-xs",onClick:()=>{localStorage.removeItem("accessToken"),o.reload(),c()},children:"로그아웃"})]})})})}l=(o.then?(await o)():o)[0],a()}catch(e){a(e)}})},7954:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{default:()=>n});var s=r(8732);r(9361);var l=r(3546),c=r(8462),i=e([l,c]);[l,c]=i.then?(await i)():i;let o=new c.QueryClient;function n({Component:e,pageProps:t}){return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(c.QueryClientProvider,{client:o,children:[(0,s.jsx)("div",{className:"sticky top-0 z-50",children:(0,s.jsx)(l.A,{})}),(0,s.jsx)("main",{className:"main-container",children:(0,s.jsx)(e,{...t})})]})})}a()}catch(e){a(e)}})},6728:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.d(t,{F:()=>c});var s=r(4243),l=e([s]);s=(l.then?(await l)():l)[0];let c={get:async(e,t)=>(await s.A.get(e,{params:t})).data,post:async(e,t,r=!1,a)=>{let l={...a,withCredentials:r};return(await s.A.post(e,t,l)).data},patch:async(e,t)=>(await s.A.patch(e,t)).data,delete:async e=>(await s.A.delete(e)).data};a()}catch(e){a(e)}})},4243:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.d(t,{A:()=>i});var s=r(1428),l=e([s]);let c=(s=(l.then?(await l)():l)[0]).default.create({baseURL:"https://www.goforme.duckdns.org",headers:{"Content-Type":"application/json"}});c.interceptors.request.use(e=>{let t=localStorage.getItem("accessToken");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e)),c.interceptors.response.use(e=>e,e=>(e.response?.status===401&&console.error("accessToken 만료"),Promise.reject(e)));let i=c;a()}catch(e){a(e)}})},6358:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.d(t,{A:()=>c});var s=r(6728),l=e([s]);s=(l.then?(await l)():l)[0];let c={getNotification:async()=>{try{return await s.F.get("/notifications")}catch(e){throw console.error("알림 get 실패",e),e}},readNotification:async e=>{try{return await s.F.patch(`/notifications/${e}`,{isRead:!0})}catch(e){throw console.error("알림 patch 실패",e),e}}};a()}catch(e){a(e)}})},3642:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.d(t,{A:()=>c});var s=r(6728),l=e([s]);s=(l.then?(await l)():l)[0];let c={getUserInfo:async()=>{try{let e=await s.F.get("/users/me");return console.log(e),e}catch(e){throw console.error("유저 정보 조회 실패",e),e}},getProfileInfo:async e=>{try{let t=e?`/users/profile/${e}`:"/users/profile";return await s.F.get(t)}catch(e){throw console.error("프로필 정보 조회 실패",e),e}},patchBasicInfo:async e=>{try{await s.F.patch("/users/update",e)}catch(e){throw console.error("기본 정보 수정 실패",e),e}},patchProfileDreamer:async e=>{try{return await s.F.patch("/users/update/profile",e)}catch(e){throw console.error("프로필 수정 실패",e),e}},patchProfileMaker:async e=>{try{return await s.F.patch("/users/update/profile",e)}catch(e){throw console.error("메이커 프로필 수정 실패",e),e}},getMakerMypage:async(e,t={})=>{try{let{page:r=1,pageSize:a=5}=t,l=`?page=${r}&pageSize=${a}`;return await s.F.get(`/reviews/${e}${l}`)}catch(e){throw console.error("메이커 마이페이지 조회 실패",e),e}}};a()}catch(e){a(e)}})},5454:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.d(t,{A:()=>i});var s=r(2177),l=r(2870),c=e([s,l]);[s,l]=c.then?(await c)():c;let i=(0,s.create)()((0,l.persist)(e=>({isLoggedIn:!1,nickName:"게스트",role:"guest",coconut:0,setLogin:(t,r,a)=>e({isLoggedIn:!0,nickName:t,role:r,coconut:a}),setLogout:()=>e({isLoggedIn:!1,nickName:"게스트",role:"guest",coconut:0})}),{name:"auth",storage:(0,l.createJSONStorage)(()=>localStorage)}));a()}catch(e){a(e)}})},2787:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var a=r(2015),s=r(7302);let l=()=>{let[e,t]=(0,a.useState)([]);return(0,a.useEffect)(()=>{let e=localStorage.getItem("accessToken"),r=new s.EventSourcePolyfill("https://www.goforme.duckdns.org/notifications/stream",{headers:{Authorization:`Bearer ${e}`}});return r.onopen=()=>console.log("SSE 연결 ON ✅"),r.onerror=e=>{console.error("SSE 연결 ERROR ❌",e),r.close()},r.onmessage=e=>{let r=e.data,a={id:new Date().toISOString(),content:r,timestamp:Date.now()};t(e=>[...e,a]),setTimeout(()=>{t(e=>e.filter(e=>e.id!==a.id))},5e3)},()=>{r.close()}},[]),{realTimeNotifications:e}}},4846:(e,t,r)=>{"use strict";function a(e){let t=new Date(e),r=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0");return`${r}-${a}-${s}`}function s(e){let t=new Date(e),r=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),l=["일","월","화","수","목","금","토"][t.getDay()];return`${r}. ${a}. ${s}(${l})`}function l(e){let t=new Date,r=new Date(e),a=Math.floor(Math.floor((t.getTime()-r.getTime())/1e3)/60);if(a<0)return"방금 전";if(a<60)return`${a}분 전`;let s=Math.floor(a/60);if(s<24)return`${s}시간 전`;let l=Math.floor(s/24);return`${l}일 전`}r.d(t,{Ns:()=>a,fw:()=>l,nk:()=>s})},4055:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var a=r(9106),s=r(3520);let l=[{key:"DEFAULT_1",src:a.A},{key:"DEFAULT_2",src:{src:"/_next/static/media/img_avatar2.b55c4002.svg",height:92,width:92,blurWidth:0,blurHeight:0}},{key:"DEFAULT_3",src:s.A},{key:"DEFAULT_4",src:{src:"/_next/static/media/img_avatar4.3a578793.svg",height:92,width:92,blurWidth:0,blurHeight:0}}]},9361:()=>{}};